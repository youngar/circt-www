<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Passes - CIRCT</title><meta name=description content="Circuit IR Compilers and Tools"><meta name=generator content="Hugo 0.64.1"><link href=https://circt.llvm.org/index.xml rel=alternate type=application/rss+xml><link rel=canonical href=https://circt.llvm.org/docs/Passes/><link rel=stylesheet href=https://circt.llvm.org/css/theme.css><script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script><link rel=stylesheet href=https://circt.llvm.org/css/chroma.min.css><script src=https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js></script><script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script><script src=https://circt.llvm.org/js/bundle.js></script><script type=text/javascript src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
    }
  });
</script><style>:root{}</style></head><body><div class=container><header><h1><div><img src=https://circt.llvm.org//circt-logo.svg width=40px align=absmiddle>
CIRCT</div></h1><p class=description>Circuit IR Compilers and Tools</p></header><div class=global-menu><nav><ul><li class=parent><a href>Community<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=https://llvm.discourse.group/c/Projects-that-want-to-become-official-LLVM-Projects/circt/40>Forums</a></li><li class=child><a href=https://discord.gg/xS7Z362>Chat</a></li></ul></li><li class=parent><a href=https://github.com/llvm/circt/tree/main/>Source<i class="fas fa-angle-right"></i></a><ul class=sub-menu><li class=child><a href=/doxygen/>Doxygen</a></li><li class=child><a href=https://github.com/llvm/circt/tree/main/>GitHub</a></li></ul></li></ul></nav></div><div class=content-container><main><h1>Passes</h1><p>This document describes the available CIRCT passes and their contracts.</p><p><nav id=TableOfContents><ul><li><a href=#transformations-passes>Transformations Passes</a><ul><li><a href=#-llhd-early-code-motion-move-side-effect-free-instructions-and-llhdprb-up-in-the-cfg>-llhd-early-code-motion: Move side-effect-free instructions and llhd.prb up in the CFG</a></li><li><a href=#-llhd-function-elimination-deletes-all-functions>-llhd-function-elimination: Deletes all functions.</a></li><li><a href=#-llhd-memory-to-block-argument-promote-memory-to-block-arguments>-llhd-memory-to-block-argument: Promote memory to block arguments.</a></li><li><a href=#-llhd-process-lowering-lowers-llhd-processes-to-entities>-llhd-process-lowering: Lowers LLHD Processes to Entities.</a></li></ul></li><li><a href=#conversion-passes>Conversion Passes</a><ul><li><a href=#-convert-firrtl-to-llhd-convert-firrtl-to-llhd>-convert-firrtl-to-llhd: Convert FIRRTL to LLHD</a></li><li><a href=#-convert-rtl-to-llhd-convert-rtl-to-llhd>-convert-rtl-to-llhd: Convert RTL to LLHD</a></li><li><a href=#-convert-llhd-to-llvm-convert-llhd-to-llvm>-convert-llhd-to-llvm: Convert LLHD to LLVM</a></li><li><a href=#-lower-firrtl-to-rtl-lower-firrtl-to-rtl>-lower-firrtl-to-rtl: Lower FIRRTL to RTL</a></li><li><a href=#-lower-firrtl-to-rtl-module-lower-firrtl-to-rtl-modules>-lower-firrtl-to-rtl-module: Lower FIRRTL to RTL Modules</a></li></ul></li><li><a href=#firrtl-dialect-passes>firrtl Dialect Passes</a><ul><li><a href=#-firrtl-lower-types-lower-firrtl-types-to-ground-types>-firrtl-lower-types: Lower FIRRTL types to ground types</a></li></ul></li><li><a href=#sv-dialect-passes>sv Dialect Passes</a></li></ul></nav><h2 id=transformations-passes>Transformations Passes&nbsp;<a class=headline-hash href=#transformations-passes>¶</a></h2><h3 id=-llhd-early-code-motion-move-side-effect-free-instructions-and-llhdprb-up-in-the-cfg><code>-llhd-early-code-motion</code>: Move side-effect-free instructions and llhd.prb up in the CFG&nbsp;<a class=headline-hash href=#-llhd-early-code-motion-move-side-effect-free-instructions-and-llhdprb-up-in-the-cfg>¶</a></h3><p>Moves side-effect-free instructions as far up in the CFG as possible. That
means to the earliest block where all operands are defined. Special care has
to be given to the <code>llhd.prb</code> instruction (which is the only side-effect
instruction moved by this pass) as it must stay in the same temporal region,
because otherwise it might sample an older or newer state of the signal.
This pass is designed as a preparatory pass for the Temporal Code Motion
pass to be able to move the <code>llhd.drv</code> operations in a single TR exiting
block without having to move operations defining the operands used by the
<code>llhd.drv</code>. It also enables total control flow elimination as the <code>llhd.prb</code>
instructions would not be moved by other canonicalization passes.</p><h3 id=-llhd-function-elimination-deletes-all-functions><code>-llhd-function-elimination</code>: Deletes all functions.&nbsp;<a class=headline-hash href=#-llhd-function-elimination-deletes-all-functions>¶</a></h3><p>Deletes all functions in the module. In case there is still a function
call in an entity or process, it fails.
This pass is intended as a post-inlining pass to check if all functions
could be successfully inlined and remove the inlined functions. This
is necessary because Structural LLHD does not allow functions. Fails in
the case that there is still a function call left in a <code>llhd.proc</code> or
<code>llhd.entity</code>.</p><h3 id=-llhd-memory-to-block-argument-promote-memory-to-block-arguments><code>-llhd-memory-to-block-argument</code>: Promote memory to block arguments.&nbsp;<a class=headline-hash href=#-llhd-memory-to-block-argument-promote-memory-to-block-arguments>¶</a></h3><p>Promotes memory locations allocated with <code>llhd.var</code> to block arguments. This
enables other optimizations and is required to be able to lower behavioral
LLHD to structural LLHD. This is because there are no memory model and
control flow in structural LLHD. After executing this pass, the
&ldquo;-llhd-block-argument-to-mux&rdquo; pass can be used to convert the block
arguments to multiplexers to enable more control-flow elimination.</p><p>Example:</p><div class=highlight><pre class=chroma><code class=language-mlir data-lang=mlir>llhd<span class=p>.</span>proc <span class=nf>@check_simple</span><span class=p>(</span><span class=nv>%condsig</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>sig<span class=p>&lt;</span><span class=k>i1</span><span class=p>&gt;</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=p>)</span> <span class=p>{</span>
  <span class=nv>%c5</span> <span class=p>=</span> llhd<span class=p>.</span>const <span class=m>5</span> <span class=p>:</span> <span class=k>i32</span>
  <span class=nv>%cond</span> <span class=p>=</span> llhd<span class=p>.</span>prb <span class=nv>%condsig</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>sig<span class=p>&lt;</span><span class=k>i1</span><span class=p>&gt;</span>
  <span class=nv>%ptr</span> <span class=p>=</span> llhd<span class=p>.</span>var <span class=nv>%c5</span> <span class=p>:</span> <span class=k>i32</span>
  cond_br <span class=nv>%cond</span><span class=p>,</span> <span class=nl>^bb1</span><span class=p>,</span> <span class=nl>^bb2
</span><span class=nl></span><span class=nl>^bb1</span><span class=p>:</span>
  <span class=nv>%c6</span> <span class=p>=</span> llhd<span class=p>.</span>const <span class=m>6</span> <span class=p>:</span> <span class=k>i32</span>
  llhd<span class=p>.</span>store <span class=nv>%ptr</span><span class=p>,</span> <span class=nv>%c6</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>ptr<span class=p>&lt;</span><span class=k>i32</span><span class=p>&gt;</span>
  br <span class=nl>^bb2
</span><span class=nl></span><span class=nl>^bb2</span><span class=p>:</span>
  <span class=nv>%ld</span> <span class=p>=</span> llhd<span class=p>.</span>load <span class=nv>%ptr</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>ptr<span class=p>&lt;</span><span class=k>i32</span><span class=p>&gt;</span>
  <span class=nv>%res</span> <span class=p>=</span> llhd<span class=p>.</span>not <span class=nv>%ld</span> <span class=p>:</span> <span class=k>i32</span>
  llhd<span class=p>.</span>halt
<span class=p>}</span>
</code></pre></div><p>is transformed to</p><div class=highlight><pre class=chroma><code class=language-mlir data-lang=mlir>llhd<span class=p>.</span>proc <span class=nf>@check_simple</span><span class=p>(</span><span class=nv>%condsig</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>sig<span class=p>&lt;</span><span class=k>i1</span><span class=p>&gt;</span><span class=p>)</span> <span class=p>-&gt;</span> <span class=p>(</span><span class=p>)</span> <span class=p>{</span>
  <span class=nv>%c5</span> <span class=p>=</span> llhd<span class=p>.</span>const <span class=m>5</span> <span class=p>:</span> <span class=k>i32</span>
  <span class=nv>%cond</span> <span class=p>=</span> llhd<span class=p>.</span>prb <span class=nv>%condsig</span> <span class=p>:</span> <span class=p>!</span>llhd<span class=p>.</span>sig<span class=p>&lt;</span><span class=k>i1</span><span class=p>&gt;</span>
  cond_br <span class=nv>%cond</span><span class=p>,</span> <span class=nl>^bb1</span><span class=p>,</span> <span class=nl>^bb2</span><span class=p>(</span><span class=nv>%c5</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span>
<span class=nl>^bb1</span><span class=p>:</span>
  <span class=nv>%c6</span> <span class=p>=</span> llhd<span class=p>.</span>const <span class=m>6</span> <span class=p>:</span> <span class=k>i32</span>
  br <span class=nl>^bb2</span><span class=p>(</span><span class=nv>%c6</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span>
<span class=nl>^bb2</span><span class=p>(</span><span class=nv>%arg</span> <span class=p>:</span> <span class=k>i32</span><span class=p>)</span><span class=p>:</span>
  <span class=nv>%res</span> <span class=p>=</span> llhd<span class=p>.</span>not <span class=nv>%arg</span> <span class=p>:</span> <span class=k>i32</span>
  llhd<span class=p>.</span>halt
<span class=p>}</span>
</code></pre></div><h3 id=-llhd-process-lowering-lowers-llhd-processes-to-entities><code>-llhd-process-lowering</code>: Lowers LLHD Processes to Entities.&nbsp;<a class=headline-hash href=#-llhd-process-lowering-lowers-llhd-processes-to-entities>¶</a></h3><p>TODO</p><h2 id=conversion-passes>Conversion Passes&nbsp;<a class=headline-hash href=#conversion-passes>¶</a></h2><h3 id=-convert-firrtl-to-llhd-convert-firrtl-to-llhd><code>-convert-firrtl-to-llhd</code>: Convert FIRRTL to LLHD&nbsp;<a class=headline-hash href=#-convert-firrtl-to-llhd-convert-firrtl-to-llhd>¶</a></h3><p>This pass translates a FIRRTL design into an equivalent structural LLHD
description.</p><h3 id=-convert-rtl-to-llhd-convert-rtl-to-llhd><code>-convert-rtl-to-llhd</code>: Convert RTL to LLHD&nbsp;<a class=headline-hash href=#-convert-rtl-to-llhd-convert-rtl-to-llhd>¶</a></h3><p>This pass translates a RTL design into an equivalent structural LLHD
description.</p><h3 id=-convert-llhd-to-llvm-convert-llhd-to-llvm><code>-convert-llhd-to-llvm</code>: Convert LLHD to LLVM&nbsp;<a class=headline-hash href=#-convert-llhd-to-llvm-convert-llhd-to-llvm>¶</a></h3><p>TODO</p><h3 id=-lower-firrtl-to-rtl-lower-firrtl-to-rtl><code>-lower-firrtl-to-rtl</code>: Lower FIRRTL to RTL&nbsp;<a class=headline-hash href=#-lower-firrtl-to-rtl-lower-firrtl-to-rtl>¶</a></h3><p>Lower the contents of an firrtl.module to the RTL dialect.</p><h3 id=-lower-firrtl-to-rtl-module-lower-firrtl-to-rtl-modules><code>-lower-firrtl-to-rtl-module</code>: Lower FIRRTL to RTL Modules&nbsp;<a class=headline-hash href=#-lower-firrtl-to-rtl-module-lower-firrtl-to-rtl-modules>¶</a></h3><p>Lower firrtl.module&rsquo;s to rtl.module.</p><h2 id=firrtl-dialect-passes><code>firrtl</code> Dialect Passes&nbsp;<a class=headline-hash href=#firrtl-dialect-passes>¶</a></h2><h3 id=-firrtl-lower-types-lower-firrtl-types-to-ground-types><code>-firrtl-lower-types</code>: Lower FIRRTL types to ground types&nbsp;<a class=headline-hash href=#-firrtl-lower-types-lower-firrtl-types-to-ground-types>¶</a></h3><p>Lower firrtl.module port types to ground types.</p><h2 id=sv-dialect-passes><code>sv</code> Dialect Passes&nbsp;<a class=headline-hash href=#sv-dialect-passes>¶</a></h2><p>[include &ldquo;SVPasses.md&rdquo;]</p><div class=edit-meta><br></div><nav class=pagination><a class="nav nav-prev" href=/docs/RationaleFIRRTL/ title="FIRRTL Dialect Rationale"><i class="fas fa-arrow-left" aria-hidden=true></i>Prev - FIRRTL Dialect Rationale</a>
<a class="nav nav-next" href=/docs/RationaleRTL-SV/ title="RTL and SV Dialect Rationale">Next - RTL and SV Dialect Rationale <i class="fas fa-arrow-right" aria-hidden=true></i></a></nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p></footer></main><div class=sidebar><nav class=slide-menu><ul><li><a href=https://circt.llvm.org/>Home</a></li><li><a href=/talks/>Talks and Related Publications</a></li><li><a href=/getting_started/>Getting Started</a></li><li class="parent has-sub-menu"><a href=/docs/>Code Documentation<span class="mark opened">-</span></a><ul class=sub-menu><li class=has-sub-menu><a href=/docs/CommandGuide/>CommandGuide<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/docs/CommandGuide/handshake-runner/>handshake-runner</a></li></ul></li><li class=has-sub-menu><a href=/docs/Dialects/>Dialects<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/docs/Dialects/ESI/>'esi' Dialect</a></li><li><a href=/docs/Dialects/FIRRTL/>'firrtl' Dialect</a></li><li><a href=/docs/Dialects/Handshake/>'handshake' Dialect</a></li><li><a href=/docs/Dialects/LLHD/>'llhd' Dialect</a></li><li><a href=/docs/Dialects/RTL/>'rtl' Dialect</a></li><li><a href=/docs/Dialects/StaticLogic/>'staticlogic' Dialect</a></li><li><a href=/docs/Dialects/SV/>'sv' Dialect</a></li></ul></li><li class=has-sub-menu><a href=/docs/ESI/>ESI<span class="mark closed">+</span></a><ul class=sub-menu><li><a href=/docs/ESI/cosim/>ESI cosimulation model</a></li></ul></li><li><a href=/docs/SVPasses/></a></li><li><a href=/docs/Charter/>CIRCT Charter</a></li><li><a href=/docs/RationaleFIRRTL/>FIRRTL Dialect Rationale</a></li><li class=active><a href=/docs/Passes/>Passes</a></li><li><a href=/docs/RationaleRTL-SV/>RTL and SV Dialect Rationale</a></li></ul></li></ul></nav><div class=sidebar-footer></div></div></div><a href=# id=backtothetop-fixed class=backtothetop data-backtothetop-duration=600 data-backtothetop-easing=easeOutQuart data-backtothetop-fixed-fadein=1000 data-backtothetop-fixed-fadeout=1000 data-backtothetop-fixed-bottom=10 data-backtothetop-fixed-right=20><span class="fa-layers fa-fw"><i class="fas fa-circle"></i><i class="fas fa-arrow-circle-up"></i></span></a></div></body></html>